
<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Ù†Ø¸Ø§Ù… Ø¥ØµØ¯Ø§Ø± Ø§Ù„Ø´Ù‡Ø§Ø¯Ø§Øª Ø§Ù„Ø°ÙƒÙŠ</title>

<script src="https://unpkg.com/pdf-lib/dist/pdf-lib.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>

<style>
body {
    font-family: Tahoma, Arial;
    background: #f4f6f8;
    padding: 20px;
    text-align: center;
}
.box {
    max-width: 600px;
    background: white;
    margin: auto;
    padding: 25px;
    border-radius: 12px;
    box-shadow: 0 10px 25px rgba(0,0,0,.1);
}
input, button {
    width: 100%;
    margin: 10px 0;
    padding: 12px;
    font-size: 16px;
}
button {
    background: #d35400;
    color: white;
    border: none;
    border-radius: 8px;
    cursor: pointer;
}
.result {
    margin-top: 20px;
    text-align: right;
}
.item {
    background: #fff;
    padding: 10px;
    border-radius: 8px;
    margin-bottom: 8px;
    display: flex;
    justify-content: space-between;
    align-items: center;
}
.item a {
    text-decoration: none;
    color: #27ae60;
}
</style>
</head>

<body>

<div class="box">
<h2>ğŸ“„ Ø¥ØµØ¯Ø§Ø± Ø§Ù„Ø´Ù‡Ø§Ø¯Ø§Øª Ù…Ù† Excel</h2>

<input type="file" id="pdfInput" accept=".pdf">
<input type="file" id="excelInput" accept=".xlsx,.xls">

<button onclick="start()">ğŸš€ Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„Ø´Ù‡Ø§Ø¯Ø§Øª</button>

<div class="result" id="result"></div>
</div>

<script>
async function start() {

    const pdfFile = document.getElementById('pdfInput').files[0];
    const excelFile = document.getElementById('excelInput').files[0];

    if (!pdfFile || !excelFile) {
        alert("ÙŠØ±Ø¬Ù‰ Ø§Ø®ØªÙŠØ§Ø± Ù…Ù„Ù PDF ÙˆÙ…Ù„Ù Excel");
        return;
    }

    const pdfBytes = await pdfFile.arrayBuffer();
    const reader = new FileReader();

    reader.onload = async (e) => {

        const data = new Uint8Array(e.target.result);
        const workbook = XLSX.read(data, { type: 'array' });
        const sheet = workbook.Sheets[workbook.SheetNames[0]];

        const rows = XLSX.utils.sheet_to_json(sheet, { header: 1 });

        for (let i = 1; i < rows.length; i++) {
            const name = rows[i][0];
            if (name) await generatePDF(pdfBytes, name);
        }
    };

    reader.readAsArrayBuffer(excelFile);
}

async function generatePDF(baseBytes, name) {

    const { PDFDocument, rgb, StandardFonts } = PDFLib;

    const pdfDoc = await PDFDocument.load(baseBytes);
    const page = pdfDoc.getPages()[0];
    const { width, height } = page.getSize();

    const font = await pdfDoc.embedFont(StandardFonts.TimesRomanBold);

    const fontSize = height * 0.055;
    const textWidth = font.widthOfTextAtSize(name, fontSize);

    page.drawText(String(name).toUpperCase(), {
        x: (width - textWidth) / 2,  // ØªÙˆØ³ÙŠØ· ØªÙ„Ù‚Ø§Ø¦ÙŠ
        y: height * 0.615,          // Ù†ÙØ³ Ù…ÙˆØ¶Ø¹ Ø§Ù„Ø§Ø³Ù… ÙÙŠ Ø§Ù„ØµÙˆØ±Ø©
        size: fontSize,
        font: font,
        color: rgb(0.44, 0.24, 0.07) // Ù„ÙˆÙ† Ù…Ø·Ø§Ø¨Ù‚ Ù„Ù„Ø´Ù‡Ø§Ø¯Ø©
    });

    const bytes = await pdfDoc.save();
    const url = URL.createObjectURL(new Blob([bytes], { type: "application/pdf" }));

    const div = document.createElement("div");
    div.className = "item";
    div.innerHTML = `
        <span>${name}</span>
        <a href="${url}" target="_blank">ğŸ‘ï¸ Ù…Ø¹Ø§ÙŠÙ†Ø©</a>
        <a href="${url}" download="Ø´Ù‡Ø§Ø¯Ø©_${name}.pdf">ğŸ“¥ ØªØ­Ù…ÙŠÙ„</a>
    `;
    document.getElementById("result").appendChild(div);
}
</script>

</body>
</html>
